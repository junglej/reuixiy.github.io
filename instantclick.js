var InstantClick=function(d,l){var c,n,r,f,h,v,i,e=navigator.userAgent,u={},g=!1,m=!1,p=!1,b=!1,y={},t=!1,T=!1,A=[],a={fetch:[],receive:[],wait:[],change:[]};function L(e){var t=e.indexOf("#");return t<0?e:e.substr(0,t)}function o(e){for(;"A"!=e.nodeName;)e=e.parentNode;return e}function E(e){do{if(!e.hasAttribute)break;if(e.hasAttribute("data-instant"))return!1;if(e.hasAttribute("data-no-instant"))return!0}while(e=e.parentNode);return!1}function w(e){do{if(!e.hasAttribute)break;if(e.hasAttribute("data-no-instant"))return!1;if(e.hasAttribute("data-instant"))return!0}while(e=e.parentNode);return!1}function H(e,t){for(var n=0;n<a[e].length;n++)a[e][n](t)}function s(e,t,n,r){if(d.title=e,d.documentElement.replaceChild(t,d.body),n){history.pushState(null,null,n);var a=n.indexOf("#"),i=-1<a&&d.getElementById(n.substr(a+1)),o=0;if(i)for(;i.offsetParent;)o+=i.offsetTop,i=i.offsetParent;scrollTo(0,o),c=L(n)}else scrollTo(0,r);C(),H("change",!1)}function Y(){T=t=!1}function x(e){B(o(e.target).href)}function M(e){var t=o(e.target);t.addEventListener("mouseout",k),i?(n=t.href,r=setTimeout(B,i)):B(t.href)}function N(e){var t=o(e.target);v?t.removeEventListener("mousedown",x):t.removeEventListener("mouseover",M),B(t.href)}function O(e){1<e.which||e.metaKey||e.ctrlKey||(e.preventDefault(),S(o(e.target).href))}function k(){if(r)return clearTimeout(r),void(r=!1);t&&!T&&(f.abort(),Y())}function D(){if(!(f.readyState<4)&&0!=f.status){if(y.ready=+new Date-y.start,H("receive"),f.getResponseHeader("Content-Type").match(/\/(x|ht|xht)ml/)){var e=d.implementation.createHTMLDocument("");e.documentElement.innerHTML=f.responseText,m=e.title,b=e.body;var t=L(g);u[t]={body:b,title:m,scrollY:t in u?u[t].scrollY:0};for(var n,r,a=e.head.children,i=0,o=a.length-1;0<=o;o--)if((n=a[o]).hasAttribute("data-instant-track")){r=n.getAttribute("href")||n.getAttribute("src")||n.innerHTML;for(var s=A.length-1;0<=s;s--)A[s]==r&&i++}i!=A.length&&(p=!0)}else p=!0;T&&(T=!1,S(g))}}function C(e){for(var t,n=d.getElementsByTagName("a"),r=l.protocol+"//"+l.host,a=n.length-1;0<=a;a--)(t=n[a]).target||t.hasAttribute("download")||0!=t.href.indexOf(r+"/")||-1<t.href.indexOf("#")&&L(t.href)==c||(h?!w(t):E(t))||(t.addEventListener("touchstart",N),v?t.addEventListener("mousedown",x):t.addEventListener("mouseover",M),t.addEventListener("click",O));if(!e){var i,o,s,f,u=d.body.getElementsByTagName("script");for(a=0,j=u.length;a<j;a++)(i=u[a]).hasAttribute("data-no-instant")||(o=d.createElement("script"),i.src&&(o.src=i.src),i.innerHTML&&(o.innerHTML=i.innerHTML),s=i.parentNode,f=i.nextSibling,s.removeChild(i),s.insertBefore(o,f))}}function B(e){!v&&"display"in y&&+new Date-(y.start+y.display)<100||(r&&(clearTimeout(r),r=!1),e||(e=n),t&&(e==g||T)||(g=e,p=b=T=!(t=!0),y={start:+new Date},H("fetch"),f.open("GET",e),f.send()))}function S(e){if("display"in y||(y.display=+new Date-y.start),r)return g&&g!=e?void(l.href=e):(B(e),H("wait"),void(T=!0));if(t&&!T)if(p)l.href=g;else{if(!b)return H("wait"),void(T=!0);u[c].scrollY=pageYOffset,Y(),s(m,b,g)}else l.href=e}var I="pushState"in history&&(!e.match("Android")||e.match("Chrome/"))&&"file:"!=l.protocol;return{supported:I,init:function(){if(!c)if(I){for(var e=arguments.length-1;0<=e;e--){var t=arguments[e];!0===t?h=!0:"mousedown"==t?v=!0:"number"==typeof t&&(i=t)}c=L(l.href),u[c]={body:d.body,title:d.title,scrollY:pageYOffset};var n,r,a=d.head.children;for(e=a.length-1;0<=e;e--)(n=a[e]).hasAttribute("data-instant-track")&&(r=n.getAttribute("href")||n.getAttribute("src")||n.innerHTML,A.push(r));(f=new XMLHttpRequest).addEventListener("readystatechange",D),C(!0),H("change",!0),addEventListener("popstate",function(){var e=L(l.href);e!=c&&(e in u?(u[c].scrollY=pageYOffset,s(u[c=e].title,u[e].body,!1,u[e].scrollY)):l.href=l.href)})}else H("change",!0)},on:function(e,t){a[e].push(t)}}}(document,location);